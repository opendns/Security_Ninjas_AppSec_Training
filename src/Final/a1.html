<!DOCTYPE HTML>

<html>
	<head>
		<title>A1 : Injection</title>
		<meta http-equiv="content-type" content="text/html; charset=utf-8" />
		<meta name="description" content="" />
		<meta name="keywords" content="" />
		<!--[if lte IE 8]><script src="css/ie/html5shiv.js"></script><![endif]-->
		<script src="js/jquery.min.js"></script>
		<script src="js/jquery.scrolly.min.js"></script>
		<script src="js/skel.min.js"></script>
		<script src="js/init.js"></script>
		<noscript>
			<link rel="stylesheet" href="css/skel.css" />
			<link rel="stylesheet" href="css/style.css" />
			<link rel="stylesheet" href="css/style-desktop.css" />
		</noscript>
		<!--[if lte IE 8]><link rel="stylesheet" href="css/ie/v8.css" /><![endif]-->
		<!--[if lte IE 9]><link rel="stylesheet" href="css/ie/v9.css" /><![endif]-->


	</head>
	<body>

		<!-- Nav -->
			<nav id="nav">
				<ul class="container">
					<img src="images/ninja.png" alt="" width="8.5%" height="8.5%" align="left" />
					<li><a href="a1.html">A1</a></li>
					<li><a href="a2.html">A2</a></li>
					<li><a href="a3.html">A3</a></li>
					<li><a href="a4.html">A4</a></li>
					<li><a href="a5.html">A5</a></li>
					<li><a href="a6.html">A6</a></li>
					<li><a href="a7.html">A7</a></li>
					<li><a href="a8.html">A8</a></li>
					<li><a href="a9.html">A9</a></li>
					<li><a href="a10.html">A10</a></li>
					<!-- <li><img src="images/opendns_logo.png" alt="" width="65.5%" height="65.5%" align="right" /> -->
				</ul>
			</nav>
			<div class="wrapper style2">
				<article id="work">
					
						<h5>A1 : Injection</h5>
					
					<div class="container">
							<b>Whois Lookup Service</b>

							<br>

							<form method="GET" action="a1_lookup.php">
							Domain Name <input type="text" name="site"><br>
							<input type="submit" value="Go">
							</form>
							</div>					
					</div>
					
				</article>
			</div>

		
		
			<div class="wrapper style4">
				<article id="contact" class="container small">
					<header>
				
						<p>There can be many types of Injection. This page has an OS Command Injection flaw.</p>
					</header>
					<div>
						<div class="row">
							<div class="12u">
							<ul>
							<li><H5 style="cursor: pointer" onclick="toggleBlock(this, 'hint1');"> Hint 1 </H5>
							<DIV id="hint1" style="display:none">
							<P>
							Manipulate Domain Name to inject an OS Command
							</P>
							</DIV></li>

							<li><H5 style="cursor: pointer" onclick="toggleBlock(this, 'hint2');"> Hint 2 </H5>
							<DIV id="hint2" style="display:none">
							<P>
							Use a separator (;) to inject an OS command in the Domain Name
							</P>

							</DIV></li>

							<li><H5 style="cursor: pointer" onclick="toggleBlock(this, 'solution');"> Solution </H5>
							<DIV id="solution" style="display:none">
							<P>
							{domain name}; {OS command}<br> e.g. &nbsp;  google.com; pwd
							</P>

							<h4>Why?</h4>
							<p style="text-align:left">
								Take a look at the GET method in <a href="https://github.com/opendns/Security_Ninjas_AppSec_Training/blob/master/src/Final/a1_lookup.php#L51">a1_lookup.php</a> (line 51). User input is stored the variable <i>$domain</i> and echoed back to the user (this is also vulnerable to <a href="https://www.owasp.org/index.php/Cross-site_Scripting_%28XSS%29">XSS</a> as the HTML control characters are not encoded when displayed). The user input is appended to the <i>whois</i> command without any sanitization (such as allowing only alphanumeric values and periods). Finally, that command is executed directly with the permissions of the web server. Whatever the web server has access to, a user now does, too (e.g. configuration files, world readable files, system info). The key lessons here are <a href="https://www.owasp.org/index.php/Data_Validation">input sanitization</a> and <a href="https://www.owasp.org/index.php/XSS_%28Cross_Site_Scripting%29_Prevention_Cheat_Sheet">output encoding</a>. OWASP has a concise summary of Injection Attacks <a href="https://www.owasp.org/index.php/Top_10_2013-A1-Injection">here</a>.
							</p>

							</DIV></li>

							</ul>
							</div>
						</div>
					</div>
					<footer>
						<ul id="copyright">
							<li>&copy; OpenDNS. All rights reserved.</li><li><a href="http://engineering.opendns.com/security/" target="_blank">OpenDNS Security</a></li>
						</ul>
					</footer>
				</article>
			</div>

	</body>
</html>